#!/usr/bin/env ruby

$:.unshift(File.expand_path('../../lib', __FILE__))
$:.unshift(File.expand_path('../../../procodile/lib', __FILE__))

$stdout.sync = true
$stderr.sync = true

trap('USR1') { Bask.config.reload ; puts "Config reloaded" }

require 'bask'

Thread.new do
  require 'bask/dns_server'
  server = Bask::DNSServer.new
  server.run
end.tap { |t| t.abort_on_exception = true }

require 'bask/web_server'
server = Bask::WebServer.new
server.run
